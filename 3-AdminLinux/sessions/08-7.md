# 8-7

## Table of Contents

- [8-7](#8-7)
  - [Table of Contents](#table-of-contents)
  - [1.Package Management](#1package-management)
  - [2.Archiving And Compressing files](#2archiving-and-compressing-files)
    - [Archiving](#archiving)
    - [Compressing Archives](#compressing-archives)
  - [3.Users and groups](#3users-and-groups)
    - [To list info related to users and groups access](#to-list-info-related-to-users-and-groups-access)
    - [group permissions](#group-permissions)
  - [Understanding the sudo Command](#understanding-the-sudo-command)
    - [Distinctions Between root and sudo](#distinctions-between-root-and-sudo)
  - [Limitations of Hard Links](#limitations-of-hard-links)

## 1.Package Management

| Debian Command        | Red Hat Command         | Description                                           |
|-----------------------|-------------------------|-------------------------------------------------------|
| dpkg                  | rpm                     | Low-level package manager                             |
| apt                   | yum/dnf                 | High-level package manager                            |
| .deb                  | .rpm                    | Package file format                                   |
| dpkg -i <package_name>| rpm -ivh <package_name> | Install a package                                     |
| dpkg -r <package_name>| rpm -e <package_name>   | Remove a package                                      |
| apt update            | yum update / dnf update | Fetches the list of available updates                 |
| apt upgrade           | yum upgrade / dnf upgrade| Upgrades all upgradable packages                      |
| apt install <package_name> | yum install <package_name> / dnf install <package_name> | Install a package and its dependencies |

**Difference between dpkg and apt:**

- **dpkg**: Installs a package without automatically installing its dependencies. It is a lower-level tool.
- **apt**: Installs a package and automatically resolves and installs its dependencies. It is a higher-level tool that acts as a front-end to dpkg, providing a more user-friendly interface for managing packages.

**apt vs yum/dnf**:

- **apt** is used in Debian-based systems like Ubuntu, while **yum** and **dnf** are used in Red Hat-based systems like Fedora (yum is the older package manager, with dnf being its successor offering improved performance and features).

**Snap:**

- A universal package manager developed by Canonical for Linux systems. It is designed to work across different distributions and provides a sandboxed environment for applications, including all their dependencies. Snap packages are self-contained, reducing conflicts with other packages.

**Basic apt commands**:

```bash
sudo apt update            # Fetches the list of available updates
sudo apt upgrade           # Upgrades all upgradable packages
sudo apt install <package_name>  # Installs a package and its dependencies
sudo apt remove <package_name>   # Removes a package but not its configuration files/dnf                 | 
```

**usage recommendation**: Always run `sudo apt update` before `sudo apt upgrade` or `sudo apt install <package_name>` to ensure you are working with the latest package information and versions as update does something like fetch.

## 2.Archiving And Compressing files

### Archiving

**tar:**
The `tar` command in Linux is used for archiving files. It combines multiple files into a single archive file but does not compress them. Compression can be applied separately using tools like `gzip`, `bzip2`, or `xz`.

**Creating an Archive with tar:**
To create an archive, use the `-c` option to create, `-v` for verbose output (shows progress), and `-f` to specify the filename of the archive.

```bash
tar -cvf archive_name.tar file1 file2 file3  # Archive multiple files
tar -cvf archive_name.tar directory_name     # Archive an entire directory
```

**Extracting an Archive with tar:**
To extract files from an archive, use the `-x` option.

```bash
tar -xvf archive_name.tar  # Extract the archive
```

**Options:**

- `-f`: Specifies the filename of the archive. This option is required when creating or extracting an archive.
- `-c`: Creates an archive.
- `-v`: Displays verbose output, showing the progress of the archive operation.
- `-x`: Extracts files from an archive.

### Compressing Archives

While `tar` itself does not compress files, it is often used in conjunction with compression tools like `gzip`, `bzip2`, and `xz` to reduce the size of the archived files.

**Compressed Archive Extensions:**

- `.tar.gz` or `.tgz`   for `gzip` compressed archives.
- `.tar.bz2`            for `bzip2` compressed archives.
- `.tar.xz`             for `xz` compressed archives.

**Creating Compressed Archives:**
You can directly create compressed archives by adding the compression option to the `tar` command.

```bash
tar -czvf archive_name.tar.gz directory_name  # gzip compression
tar -cjvf archive_name.tar.bz2 directory_name # bzip2 compression
tar -cJvf archive_name.tar.xz directory_name  # xz compression
```

**Options for Compression:**

- `-z`: Use `gzip` compression.
- `-j`: Use `bzip2` compression.
- `-J`: Use `xz` compression.

**Extracting Compressed Archives:**
The `tar` command can automatically detect the compression type and extract the files accordingly.

```bash
tar -xvf archive_name.tar.gz   # Extract gzip compressed archive
tar -xvf archive_name.tar.bz2  # Extract bzip2 compressed archive
tar -xvf archive_name.tar.xz   # Extract xz compressed archive
```

**Note:** While extracting, the `-v` option is optional but useful for monitoring the progress of the extraction.

## 3.Users and groups

1. **Normal User:**
   - Typically has an ID in the range of 1000 to 40000.
   - These users which are created with interact with the system for regular operations.

2. **System User:**
   - Assigned user IDs within the range of 1 to 999.
   - Essential for initiating system processes and services utilized by regular users.
   - Specifically created for the operation of system services and daemons, without the intention for direct login or interactive sessions.
   - does not a home directory for personal file storage, which created for normal user accounts.
   - Enhances system security by restricting process permissions, minimizing damage if compromised.
   - **`Daemon` System User Characteristics:**
     - **Limited Privileges:** Configured with only the necessary permissions for their tasks, adhering to the principle of least privilege to mitigate security risks.
     - **No Login Shell:** Designed without the ability for interactive login, emphasizing their role in process execution over user interaction.

    ```bash
        # list all system users
        $ awk -F: '($3 >= 1) && ($3 <= 999) {print $1}' /etc/passwd
        daemon          bin         sys      sync     games        man       lp      mail      news         uucp           proxy       www-data        backup         list        irc    gnats         systemd-network      systemd-resolve      messagebus       systemd-timesync      syslog       _apt        tss        rtkit       systemd-coredump       kernoops     uuidd        cups-pk-helper         lightdm            tcpdump         speech-dispatcher           avahi-autoipd       usbmux       nm-openvpn        geoclue           dnsmasq        pulse          _flatpak           avahi       saned        colord        fwupd-refresh         hplip       sssd      sshd
    ```

3. **Service User:**
   - Service users have IDs typically between 200 and 666.
   - These accounts are used exclusively for running specific services or daemons on the system.
   - Unlike normal users, service users do not log in interactively but are essential for the operation of background processes.
   - These users are created to isolate the privileges of different services, enhancing the security by limiting the potential impact of a compromised service.

    **Key Points:**
    - Service users are a subset of system users with the specific role of managing individual services.
    - Services run by these users are started by the system user, ensuring that even if a service is compromised, the attacker gains access only to the privileges assigned to that service user, not the entire system.

**SSH Connection Process:**
    - When a client connects to the server via SSH(service user), the server initiates a process for the client. This process is initially created by the system user, who owns the SSH daemon (`sshd`) service.
    - Although the process is initiated in the context of the system user (who owns the `sshd` service), it effectively runs under the normal user's ID once the connection is established. This means the normal user becomes the owner of the process for the duration of their SSH session.
    - The flow can be summarized as:
  `Normal User --requests service--> System User --creates process under normal user's ID--> SSHD Service is running for the user`.

**Additional Information:**

- **UID Ranges:** The UID (User ID) ranges for normal, system, and service users help in segregating system resources and permissions, ensuring a structured permission model that enhances security and manageability.
- **User and Group IDs:** Each user is also associated with a primary group ID (GID), which can play a role in determining access permissions for shared resources.
- **Security Context:** The separation of user types into different ID ranges also aids in setting security policies and auditing system access and usage.

[Creating And Deleting Users And Groups](../tasks/AdminLinux_Task4/readme.md )

**for Adding user to group** use -ag for primary group and -aG for secondary group

### To list info related to users and groups access

`/etc/passwd` -> users file
`/etc/group` -> groups file
`/etc/shadow` -> password file
`/etc/sudoers` -> sudo file

### group permissions

users are spilitted into groups each one has its own permissions.

```bash
$ sudo nano  /etc/sudoers
    # Allow members of group sudo to execute any command
    %sudo   ALL=(ALL:ALL) ALL
    %hero   ALL=(ALL:ALL) ALL #add this line
```

## Understanding the sudo Command

The `sudo` command consults the `/etc/sudoers` file to verify if a user has the necessary permissions to execute a specified command.

- The `/etc/sudoers` file allows for granular control over user permissions, including specifying commands a user or group can run as other users.
- It's crucial to manage the `/etc/sudoers` file with care, using `visudo` for editing to prevent syntax errors and potential security breaches.

### Distinctions Between root and sudo

1. The `sudo` command is not applicable to shell built-in commands like `cd` or `echo`.
2. Unlike regular users with `sudo` privileges, the `root` user inherently possesses all permissions without restrictions.
3. Directories under `/sys` are typically not accessible with `sudo` due to their sensitive nature and kernel-level security restrictions but can be accessed by the `root` user.
4. `su` switches to root user.

## Limitations of Hard Links

Hard links cannot span across different devices because they are essentially pointers to the inode of a file, and inodes are device-specific. Each device maintains its own inode table, making it impossible to create a hard link between files on separate devices.
